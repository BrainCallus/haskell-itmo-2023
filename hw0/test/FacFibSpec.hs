module FacFibSpec
  ( facTest
  , sampleFibTest
  ) where

import           Data.Maybe          (fromMaybe)
import           Hedgehog            (forAll, property, withTests, (===))
import           HW0.T4              (fac, fib)
import           Test.Hspec
import           Test.Tasty          (TestTree, testGroup)
import           Test.Tasty.Hedgehog (testProperty)
import           TestBase
import           Text.Read           (readMaybe)

facTest :: TestTree
facTest =
  testProperty "factorial test"
    $ withTests
        10
        (property $ do
           forAll genNatural >>= \x -> do
             product [1 .. x] === fac x)

sampleFibTest :: TestTree
sampleFibTest =
  testGroup "sample fib test"
    $ toTestTree . (\(x, y) -> fib x `shouldBe` y)
        <$> [ (0, 0)
            , (1, 1)
            , (2, 1)
            , (3, 2)
            , (4, 3)
            , (9, 34)
            , (10, 55)
            , (50, 12586269025)
            , (38, 39088169)
            , ( 729
              , 100578404047763437394925058182912858967758816645240854669260846530023147100649579758906802170865134804283198088355735627634798716539277515304438631163554)
            , ( 1000
              , 43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875)
            , (129, 407305795904080553832073954)
            , ( 655
              , 34468260105109870017385177312438050697027533834851412505302058429736597230270443860863973247044430446588302156705501747391672816199086845)
            , (100000, fromMaybe 0 (readMaybe longAnswer))
            ]

longAnswer :: String
longAnswer =
  "25974069347221724166155034021275915414880485386517696584724770703952534543511273686265556772836716744"
    ++ "7546375872230744321116383994738750910309656973821883044930522876385313349213530267927895670105127657827163560807"
    ++ "3050532200243233114383986516137827238124777453778337299916214634050054669860390862750996639366409211890125271960"
    ++ "1721050603003505868940285581036751176582513683774386849364134573388343651587754253719124105003321959913300622043"
    ++ "6303521375652542182399869084855637408017925176162939175496345855861630076281991608110983652635299544069428420657"
    ++ "1046044903805647136346033000520852277707554446794723709030979019014860432846819857961015951001850608264919234587"
    ++ "3133991501339199323631023018641725364771362664750801339824312317034314529641817900511879573167668349799016820118"
    ++ "4990775668645684506628739248560391404760519955006628882634587718941068037009187936500173301171002831047394745625"
    ++ "6091444932821374855573864080579813028266640270354294412104919995803131876805899186513425175959911520563155337703"
    ++ "9969410355182752749199598022575079020377981030899229849963044962558140455170002502997643221934621653662108418767"
    ++ "4542829826139823447836658158804081900330738293950008213200937471548513102722081730543226486694963098791471436292"
    ++ "5554252624043999615326979876807510646819068792118299167964409178271868561702918102212679267401362650499784968843"
    ++ "6809752547001310045741864064482994858725517447466956518791269169932445648176733222571493149677633458466238303338"
    ++ "2023970243685947828764187578857291071013370030009422933359729277919140921280490154597626279105705524815888405177"
    ++ "9418192905216769576608748815567860128818354354292307397810154785701328438612728620176653953444993001980062953893"
    ++ "6985500723286651317181135886613537472684585432548981137176605194616937916884425342594781263103889520479565943807"
    ++ "1530191125396484711263890071336285691015514534233294412843572209962867461194209516610023097407099655319005081586"
    ++ "6991144544264788287264284501725332048648319457892039984893823636745618220375097348566847433887249049337031633826"
    ++ "5717607297788917989136673251906232471180372801739215723908227692280772924566627505383375006926077210593619421268"
    ++ "9203025674435653780083183063759333450235025697290651528532719436775601566603991640488256396769307929050295148869"
    ++ "3413799125174856667074717514938979038653338139534684837808612673755438382110844897653836848318258836339917310455"
    ++ "8509056638462025014631311831087429077292622159430204291594740306101839816855066950261973761508571761199475875722"
    ++ "1298720531206079186498036159609233959410411863516885488391191851790615115627529361584900087215019222651178531508"
    ++ "9251027528045151238603792184692121533829287136924321527332714157478829590260157195485316444794546750285840236000"
    ++ "2383447905203451080332820138038807089807348326201227952633606773669875783326254859449060219173688677862411205621"
    ++ "0983698501972901771578011204045864915393511578349954610063663574544850824188827906753135995051920622297601537652"
    ++ "9797308588164873117308237059828489404487403932053592935976454165560795472477862029969232956138971989467942218727"
    ++ "3605123365595211331087787582288795975803204596084790245063851941743126163775104599211024868794963417068620929088"
    ++ "9306852523480569259983337751039010131661781230511457193270662916712544651215174680254819035835168897170757067786"
    ++ "5618800822034683632101813026232996027599403579997774046244952114531588370357904483293150007246173417355805567832"
    ++ "1534543411700202585608091662941986374015145695722728369219632295111877625307534025947814482046574602884855000628"
    ++ "0693481139827601685558407954216205754355729151064153759293902288435612079264370556006236798654438246437394697247"
    ++ "1945996555795505838034825597839682776084731530251788951718630722761103630509360074262261717363058613291544024695"
    ++ "4329046162586917746305785076749374879923291817501634840688134655343709975893536074051729094126976575932951568186"
    ++ "2474712763646883655175701835341727466260730651045119576286634992284867878059108511898565355543495876166401644758"
    ++ "8028633629704046289097067736256584300235314749461233912068632146637087844699210427541569410912246568571204717241"
    ++ "1333784898167640969249816334211768571503116710400681753031921154156119580425706586931272762137106974722260296555"
    ++ "2461105371555453249975084327520019921430191050536299600704296329780510306665063878626815765877268374512897685079"
    ++ "6366371059380911225428835839194121154773759981301921650952140133306070987313732926518169226845063443954056729812"
    ++ "0315463923249817937804691037934221694952291007930299492375072993250630509428139027930841344730614116433556147640"
    ++ "9310442591848136393054236937897652052645634764831827263337151211203062923388928648794920973784786188486826080464"
    ++ "7319539200840398308008803869049557419756219293922110825766397681361044490024720948340326796768837621396744075713"
    ++ "8872928630798218493143438797780887379588968409461434159271317578365114578289355818599029235343888888465874521308"
    ++ "3813777944363611976283903689459576012031650227985790154534474735270697285145459986142290273729113146378204551622"
    ++ "5447535356773622793648545035710208644541208984235038908770223039849380214734809687433336225449150117411751570704"
    ++ "5610508952740002063804979679604026178186644812485472696308234733772455433905198413087697812765659167642290229481"
    ++ "8176307571025579336500815228638363449313808997178508707086363220586901893837776606300606675773242727292924742129"
    ++ "5265000706646722730009956124191409138984675224955790729398495608750456694217771551107346630456603944136235888443"
    ++ "6762152739285970722879373559667239246138274687032178584599482575147454064364609970593161205968415604732343966524"
    ++ "5723165031779283386059038836041769142873273570398680334260467007171736357309112298130690328613712259793709660577"
    ++ "5172964528263757434075792282180744352908669606854021718597891166333863858589736209114248432178645039479195424208"
    ++ "1916260885710691104339948014730131008698488664307212167624731196181907378207665829682807960794822595490363282665"
    ++ "7800699485682530053643667482253460370513450360315215429694399186623685763806235120988444874113860017117364763212"
    ++ "6029961408561925599707566827866778732377419444462275399909291044697716476151118672327238679208133367306181944849"
    ++ "3966071233452718565202536436219641987827529788130600803131418170693144682211892757849782810943677515407101063505"
    ++ "5379800384221904550848223938699329692665922111274269813306230007346562849809363669304944680162855371263341262037"
    ++ "8491919498600097200836727876650786886306933418995225768314390832484886340318940194161036979843833346608676709431"
    ++ "6436535384309121578155435128520777208580989020995864496024794919706872307656871092343807195098248144731578137800"
    ++ "8063935841875665509850132188285284018498140769073850736953537771188038852893534760093033859869160828933542114772"
    ++ "2936561907276264603726027239320991187820407067412272258120766729040071924237930330972132364184093956102995971291"
    ++ "7998282900095391473824378027790511120309545825328887211461701334403859396540478061993332245473178034073409025121"
    ++ "3021727959575386315814881039295247541094388055509838262763312760671812617102201135618180077540022751673414416921"
    ++ "6424973175621363128588281978005788832454534581522434937268133433997710512532081478345067139835038332901313945986"
    ++ "4818202723220433419309290119078328965692228783374973543015617228291156273294688148532819221007523736268276431526"
    ++ "8573549322302801810144964900901552924863833888566489300225097434360120081436515362536919944670971112695196672578"
    ++ "0061891215440222487564601554632812091945824653557432047644212650790655208208337976071465127508320487165271577472"
    ++ "3258872757611283575921325539344462894332581050286335836692918285668947362235082502949640657986308096143416968304"
    ++ "6759517435531322436266420719760845902426301747339222529124836631642800655287097505199750491300985946807101360233"
    ++ "6440164400179188610853230764991714372054467823597211760465153200163085336319351589645890681722372812310320271897"
    ++ "9179512727996560536940321112428465909945563802154613161062675216338056643943188812681994940055370686976218552318"
    ++ "5892110096344101293353573391845966819753983428469682288946007635203168892200202193131836975755696206111577430582"
    ++ "6305535862015637891246031220672933992617378379625150999935403648731423208873977968908908369996292995391977217796"
    ++ "5334212492919783837514600620549673416628334873410110977705358980664981360113955715843283087139405825352740560810"
    ++ "1150390794168807919721293314830307263867863141103844312821599493682434299818871976863760449634259752425688618868"
    ++ "8978980888315865076262604856465004322896856149255063968811404400429503894245872382233543101078691517328333604779"
    ++ "2627277656860761777056168740502577437499837758301438561354272738385897741335269491654839297215195547935789238667"
    ++ "6250274537010466090938244962662693532130374453889247921616118888970207791044856319951482663080287954954645358386"
    ++ "6307344423753319712279158861707289652090149848305435983200771326653407290662016775706409690183771201306823245333"
    ++ "4779666605253254908736019614803782415660712716503835822572892157082093695109958901328594907243061833257552012080"
    ++ "9000717502202294974280182344541371191629844991472225419659468222146826064496183925424967090310400758148885797167"
    ++ "2246322887016438403908463856731164308169537326790303114583680575021119639905615169154708510459700542098571797318"
    ++ "0155647414061723341458471112685479298924430013914682891036791792169786165824890073220335913767065276765213071439"
    ++ "8530276098847805621699465965546137917498565973922737941672649537780199209835542786617912312669937473077773056932"
    ++ "4430166839333011554515542656864937492128687049121754245967831132969248492466744261999033972825674873460201150442"
    ++ "2287804661243201830161082321839086547710423982285313165596856880052265714744288233175394565438819286244326625033"
    ++ "4538819959008510521138312449186180262443219554043398572284134125440941177172215686708629174212405311062052284298"
    ++ "6199273629406208834754853645128123279609097213953775360023076765694208219943034648783348544492713539450224591334"
    ++ "3746649377016556057633846970629187257454265058794146301766397604574743110815567470916527087481252671599137932405"
    ++ "2730461369396116989258980831190632251077792856207199945948770061180100229613230458829455844095249661115834280490"
    ++ "8643860880796440557763691857743754025896855927252514563404385217825890599553954627451385454452916761042969267970"
    ++ "8935800562345019185714890304184957674008193599732187119574963570959678251710962647520688908064076514458931328707"
    ++ "6745416960710793169270428516809341331104635350624220981036321677191042078616218421376393819462569728678141363638"
    ++ "9620123976910465418956806197323148414224550071617215851321302030684176087215892702098879108938081045903397276547"
    ++ "3264169168454456276007595613671035845756490944306924525320850030910687831575615198475675691912847846546925586651"
    ++ "1155791346127242533608363513134218390517715451122846445513601601351322894854327150476083930755610090878609666387"
    ++ "0612278690274831819331606701484957163004705262228238406266818448788374548131994380387613830128859885264201992286"
    ++ "1882084995886408885213525014576153964826474510259025307431729568996364996157075518558371659353671254485150893629"
    ++ "0456773663003556245737477910098799249914696722404148160128953094401548894261378314008780431143174185807182618514"
    ++ "9051138744831358439067228949408258286021650288927228387426432786168690381960530155894459451808735197246008221529"
    ++ "3439808282541261282571572093509853828007385604729109411840060844852353778335033068619777245018863640703449733664"
    ++ "7310060201812879288699186182441845396899477725948216913713364747045317297980924584436112961899759569624097184556"
    ++ "4020511432589591844724920942930301651488713079802102379065536525154780298059407529440513145807551537794861635879"
    ++ "9011581920198088796949671874482241568364635343261602426329347616344581638901638051238941845239734218414968892623"
    ++ "9848964864209340981668149477115517700956266902985010151353759980127250124197111987152659374748477893548877781519"
    ++ "2931171431167444773882941064615028751327709474504763922874890662989841540259350834035142035136168819248238998027"
    ++ "7066669163421334243120545073593886166876911881857761181357713324839652098820859823912986063868228047543624089565"
    ++ "2292141085985203733054462595326134023486468927506052689375514840329854208699122105259700562857670770256769530097"
    ++ "8970046408920009852106980295419699802138053295798159478289934443245491565327845223840551240445208226435420656313"
    ++ "3107029407223715527705042634820739844548895892488613976570791454144276535845729513297190919476944119109667974742"
    ++ "6267559095383203916967349426136003226307742868410504006135105219441377815809500571452684600981035210924904002795"
    ++ "8050736436961021241137739717164869525493114805040126568351268829598413983222676377804500626507241731757395219796"
    ++ "8907548251993292596498016270686656580301788774056151671597319273204793762473755058550528396602945669925221736008"
    ++ "7408121201420907104193759857172143133801742514158249182471090508471597724941704932025416523932323325885158889333"
    ++ "7097136310892571531417761978326033750109026284066415801371359356529278088456305951770081443994114674291850360748"
    ++ "8523666547448699280832305168157116029118363741479584921008605289814695477508123388969431528610212027367470499039"
    ++ "3041703517134212692348670056662750622905863691188222890317051030540688209697087554532936943406398129769647803182"
    ++ "5451642178347347716471058423238594580183052756213910186997604305844068665712346869679456044155742100039179758348"
    ++ "9799358827518815246759308789281592434921975453876683056846684207754098217812470533545231947973989533201759886402"
    ++ "8105882555769800439712053831245942895737769600185749733524996501350936892595802186381172590650643688212715681575"
    ++ "1021712900765992750370228283963962915973251173418586721023497317765969454283625519371556009143680329311962842546"
    ++ "6284031424443706484323903749064108113007928489557672434812000903098884572709077508736388732996425550504738125289"
    ++ "7596293482287891761992072513830938828829251041683762275820408191893360365387528411678570372098971883298692192781"
    ++ "6629675844580174911809119663048187434155067790863948831489241504300476704527971283482211522202837062857314244107"
    ++ "8237925136450866775666228049772113971406216641163247567842166129614771090188260946773776864061767214842938949766"
    ++ "7138012278894130902655351109611834701256519754080709538406091686393690667378662720942943426426040290215831734500"
    ++ "3727462588992622049877121178405563348492490326003508569099382392777297498413565614830788262363322368380709822346"
    ++ "0122742413790364734517359252157547571609342709351929017239549214264906911152715233381091240428121028937384881673"
    ++ "5895393450893069771552298919969890388588327540904430032198683400347027122002015969937169065033054757709539874858"
    ++ "0670024491045504890061727189168031394528036165633941571334637222550477547460756055024108764382121688848916940371"
    ++ "2589019484906853797222445620094838194915327245022762185891695074057949837598210066044819965193601102615769471762"
    ++ "0257170204868491461689406840414083358756211831921083800563214456201894150594578002531874747191160484067799776541"
    ++ "4830622179069330853875129298983009580277554145435058768984944179136535891620098725222049055183554603706533183176"
    ++ "7161107380097866252474886914760776644701471930744763024116603356717655648744405779905319962716329720091094492492"
    ++ "1645603061882777294775076477744645258632891915910744425232008291820951802108370035388133098321589460868012795422"
    ++ "4752071924134648334963915094813097541433244209299930751481077919002346128122330161799429930618800533414550633932"
    ++ "1393396468616164169552202164479954172431711657444713641977332048993650747678441499295480730258564429423817876415"
    ++ "0649287836176797867715851078423570264021338801887560198923405686842321558562850864552525837701062053222424498799"
    ++ "0625263484010774322488172558602233302076399933854152015343847725442917895130637050320444917797752370871958277976"
    ++ "7996861136265322911186296311646851599346606934605575459560631558300336976340002766851512938436388860908283761411"
    ++ "5773200352756515874590656702543943793110483857131329449060492658236310894953509008267315449722639664808861804157"
    ++ "3977888472892174618974189721700770009862449653759012727015227634510874906948012210684952063002519011655963580552"
    ++ "4291802055869042596852610474128345184667369385800277002529653563667216198836724282269339503259303909945831686655"
    ++ "4223465485702087550461752052185372156728267990341813552060299989536647010655790053212954133692447249221243632452"
    ++ "3042895188461779122338069674233980694887270587503389228395095135209123109258159006960395156367736067109050566299"
    ++ "6035718764232479207528361608055976977787564767672105212223271848214844466312614875842260926088757643317310232637"
    ++ "6886482259469121103236773755812213347055680595800831012748167396201958359802396741448986727684586981937678375716"
    ++ "7936723213081586191045995058970991064686919463448038574143829629547131372173669836184558144505748676124322451519"
    ++ "9433621829161914680260911217930018647880500613516031443500761892134416024880917410512322903571792054979279709245"
    ++ "0247994084269615881844261616378004475947821224087320412442116919980557264911824366192183571476289142580577187174"
    ++ "3688000324113008704819373962295017143090098476927237498875938639942530595331607891618810863505982444578942799346"
    ++ "5149159528848697574880258233535716778648268280511408854297327881977657369660057277001625924043016886599468629837"
    ++ "1727059580980873090182012093100343005879655269478804980920548430546761103465474806729067439976361259243463771999"
    ++ "5843862812391985470202414880076880818848087892391591369463293113276849329777201646641727587259122354784480813433"
    ++ "3280500877588552646861195769621722393086937957571658218524162043419723839899327348034292623407223381551022091012"
    ++ "6294924974242327169884202329730326016179057567311123546589029829831311512360760677396899815381228699964201460985"
    ++ "2579793691246016346088762321286205634215901479188632194659637483482564291616278532948239313229440231043277288768"
    ++ "1395502133482663886874532592815878545038909915619496324788550350902893909737189880039990261320158726786378730956"
    ++ "7810962531100805448941885798356590206368069964316503391202994432772677086930524071841659207009613928640196672575"
    ++ "0087012218149733133695809600369751764951350040285926249203398111014953227533621844500744331562434532484217986108"
    ++ "3462613458975912348399707518542232816771872159568272432459108290198863903697845426225669125427470560975679848571"
    ++ "3662367902387847816120147798293908051315025817452377352951016529693456278612224115078358775537334837276443983808"
    ++ "2000667214740034466322776918936967612878983488942094688102308427036452854504966759697318836044496702853190637396"
    ++ "9163579809288657199353977234954867871804164014152814894437850362910715178052858575839877111454742401564164771941"
    ++ "1639135493546675559359260884920054638468540302808093641725058365336809340722531082084472357022680982695142616245"
    ++ "1204040711501448747856199922814664565893938488028643822313849852328452360667045805113679663751039248163336173274"
    ++ "5472757756368109773445392758275605974251607054686896577945305216023159398657809748015154149870977780787053570580"
    ++ "0847237689242218975031275852714017311762127989874495840619984391336568029772120875193498850449971391428515803232"
    ++ "4823021340630312586072624541637765234505522051086318285359658520708173392709566445011404055106579055037417780393"
    ++ "3516583609045430477214222818168325396136349825252152322576909202542164096574526180660517779015929028842405999988"
    ++ "8275369195754011695469615227040128085757976615472219292565596399182094889464265751228876633030213374636744921744"
    ++ "9351637104725732980832812726468187759356584218383594702792013663907689741738962252575782663990809792647011407580"
    ++ "3678505993818871845600946958332707751261812820153910417739509182441375619999378192403624695582359241714787027794"
    ++ "4844310875190180741411029037070605208516297579836175425104164224486757735075633801889537926318338985595595652785"
    ++ "7227926155524494739363665533904528656215464288343162282921123290451842212532888101415884061619939195042230059898"
    ++ "3499665694635801868167170748188232158486477343867809115646607551753855522244285240494680336922999893007839000206"
    ++ "9012151774069642857393019691050098827852305379763794025796895329511243616677891058555721338178908994545394791592"
    ++ "7374958600268237844486872037243488834616856290097850532497036933361942439802882364323553808208003875741710969289"
    ++ "7254998785662530488670330951505184521269449892515963920794214526065085160523256148619382824898380008150853515646"
    ++ "4276170083209648311794440197178014921334533590333667237671922972206997076605548245224741692777463752213520171623"
    ++ "1722137632445699154022395494158227418930589911746931773776518735850032318014432883916374243795854695691221774098"
    ++ "9486115155640466095650945381155209218637115186845625432750478705300069984231401801694211091059254935961167194576"
    ++ "3096232883127126832850176032177168040024965767418692711321557327004993570994232441638708924242758440765121557267"
    ++ "6037924765341808984312676941110313165951429479377670698881249643421933287404390485538222160837088907598277390184"
    ++ "2041381978110258545370885867014506235785139601099874760525354501004393530620724397099764451467909933814489946446"
    ++ "0978095773195360493873495002686056455569322422969181563029392248760647087343116638420544248962876021365024699189"
    ++ "3040112513103835085621908060270866604873585849001704200923929789193938125116798421788115209259130435572321635660"
    ++ "895603514383883939018953166274355609970015699780289236362349895374653428746875"
